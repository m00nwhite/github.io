---
layout: post
title:  "Vue 笔记"
date:   2021-08-27 12:10:25 +0800
categories: vue
---

# Vue 笔记


## Vue安装
Vue官网： [vuejs.org](https://vuejs.org)

可以使用以下几种方式来安装使用Vue
1. 下载vue.js后直接放在项目工程中引用
   下载地址：https://cn.vuejs.org/v2/guide/installation.html
   
   ![](https://yinyang.space/img/20210828_vue_01.png)

2. 使用CDN
开发环境
```html
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
```

生产环境
```html
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.14"></script>
```

使用原生ES Modules
```javascript
<script type="module">
  import Vue from 'https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.esm.browser.js'
</script>
```

使用NPM安装（构建大型应用时推荐使用NPM安装）

```bash
cd front;
npm install vue
npm install -g vue
npm install -g vue-cli
npm install -g webpack

```


## 初识Vue

第一个Vue页面
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hello Vue</title>
    <script type="text/javascript" src="../js/vue.js"></script>
</head>
<body>
    <!-- 准备好一个容器 -->
    <div id="root">
        <h1>Hello, {{name}}</h1>
    </div>
    <script>
        Vue.config.productionTip = false  // 阻止 vue在启动时生成生产提示。

        // 创建 Vue 实例
        const vm = new Vue({
            el:'#root',     // el用于指定当前Vue实例为哪个容器服务，值通常为css选择器字符串。
            data:{          // data用于存储数据
                name: 'Vue'
            }
        });
    </script>
</body>
</html>
```

* 想让Vue工作，需要创建一个Vue实例，并且要传入一个配置对象；
* root容器里的代码依然符合html规范；
* root容器与Vue实例之间是一一对应的，一般真实开发中只有一个Vue实例，并且会配合着组件一起使用；
* `{{ }}`中可以放置js表达式，比如`{{1+1}}`，`{{Date.now()}}`；
* 一旦data中的数据发生改变，那么页面模版中用到该数据的地方也会自动更新。


```html
<div id="root1">
    <h1>Hello, {{name}}, {{age}}</h1>
</div>
<div id="root2">
    <h1>Hello, {{name}}, {{address}}</h1>
</div>
<script>
    Vue.config.productionTip = false  // 阻止 vue在启动时生成生产提示。

    // 创建 Vue 实例
    const vm1 = new Vue({
        el:'#root1',     // el用于指定当前Vue实例为哪个容器服务，值通常为css选择器字符串。
        data:{          // data用于存储数据
            name: 'Vue',
            age: 18
        }
    });
    const vm2 = new Vue({
        el:'#root2',     // el用于指定当前Vue实例为哪个容器服务，值通常为css选择器字符串。
        data:{          // data用于存储数据
            name: 'GeekHall',
            address: 'beijing'
        }
    });
</script>
```

输出结果
```
Hello, Vue, 18
Hello, GeekHall, beijing
```


## Vue 开发者工具
上面的案例在执行的时候F12打开控制台会看到下面的一行提示内容
![](https://yinyang.space/img/20210828_vue_03.png)

是因为我们没有安装Vue开发者工具

可以在VueDevTools官网[https://devtools.vuejs.org/](https://devtools.vuejs.org/)

或者GitHub[https://github.com/vuejs/devtools](https://github.com/vuejs/devtools)

来下载安装

Chrome浏览器可以在Chrome 网上商店直接下载安装
![](https://yinyang.space/img/20210828_vue_04.png)


使用：
可以直接在F12界面中找到Vue开发者工具的Tab页，在这里可以直接执行修改绑定数据等操作。
![](https://yinyang.space/img/20210828_vue_02.png)

另外一个需要注意的是，如果使用`file://`的方式打开html的话开发者工具是不会生效的。
![](https://yinyang.space/img/20210828_vue_06.png)

这里推荐使用VSCode的liveServer扩展，可以直接在vscode中使用`http://127.0.0.1:5500`来调试本地html。



## Vue模版语法
1. 插值语法（Interpolation）

```html
    <div id="root">
        <h1>Hello, {{name}}</h1>
    </div>
    <script>
        Vue.config.productionTip = false;
        new Vue({
            el:'#root',  
            data:{         
                name: 'Vue'
            }
        });
    </script>
```


2. 指令语法（v-bind）
指令语法用于解析标签（包括：标签属性、标签体内容、绑定事件……）

v-bind会把引号中的内容当作js表达式来执行

```html
<div id="root">
    <h1>指令语法：</h1>
    <!--
        这里会把引号内的url当作js表达式来执行，
        并将执行结果https://geekhall.cn绑定给href属性。
    -->
    <a v-bind:href="url">极客堂</a>
</div>
<script>
    Vue.config.productionTip = false;
    new Vue({
        el:'#root',  
        data:{         
            name: 'Vue',
            url: 'https://geekhall.cn'
        }
    });
</script>
```

插值语法一般用在标签体内容，
指令语法一般用在标签属性内容，

3. 双向数据绑定

```html
<div id="root">
    <h1>单向数据绑定</h1>
    <input type="text" v-bind:value="name1">
    <hr/>
    <h1>双向数据绑定</h1>
    <input type="text" v-model:value="name2">
</div>
<script>
    Vue.config.productionTip = false  // 阻止 vue在启动时生成生产提示。

    // 创建 Vue 实例
    new Vue({
        el:'#root',
        data:{
            name1: 'Vue',
            name2: 'Vue'
        }
    });
</script>
```
![](https://yinyang.space/img/20210828_vue_07.png)

注意v-model只能应用在表单类元素上。

`v-bind:name`可以简写成`":name"`

例如：`v-bind:href="xxx"` 可以简写为：`:href="xxx"` ，

`v-model:value`可以简写成`"v-model"`

例如：`v-model:value="xxx"` 可以简写为：`v-model="xxx"` ，


## 另一种绑定元素的方法

除了使用el来绑定页面元素后，还可以使用mount来绑定元素。
```javascript

<div id="root">
    <div>
        <h1>Hello, {{name}}</h1>
    </div>
</div>
<script>
    Vue.config.productionTip = false  // 阻止 vue在启动时生成生产提示。

    // 创建 Vue 实例
    const v = new Vue({
        // el:'#root',
        data:{
            name: 'Vue'
        }
    });
    v.$mount('#root');
</script>
```

## data的另一种写法(函数式)

```javascript
const vm = new Vue({
    data: function(){
        console.log('@@@@@:', this);
        return{
            name: "Vue"
        }
    }
});

v.$mount('#root');
        
```
注意这里的data函数不能写成箭头函数，否则函数内的this会指向Window，而不是Vue实例了。
* 由Vue所管理的函数，一定不要使用箭头函数。

但是可以简写成下面的方式：
```javascript
const vm = new Vue({
    data(){
        console.log('@@@@@:', this);
        return{
            name: "Vue"
        }
    }
});
```

## MVVM模型
* M：Model，data中的数据
* V：View， 模版代码
* VM： 视图模型，Vue实例

Tips
* data中所有的属性，最后都出现在了vm身上
* vm的所有的属性，及Vue原型上所有的属性，在Vue模版中都可以直接使用。

### Getter和Setter

```javascript
let number = 18;
let person = {
    name: '赵四',
    sex: 'Male'
}
Object.defineProperty(person, 'age', {
    get: function (){
        return number;
    }
    set(value) {
        number = value;
    }
}

console.log(person); 
```
Setter使用的是_data

一旦data中的数据发生改变，那么页面中用到该数据的地方也会自动更新；

### 数据代理
通过一个对象代理对另一个对象中属性的操作
将data中的属性通过Object.defineProperty来绑定_data，从而方便的操作data中的属性。
_data中做了数据劫持（响应式的原理）


## v-on事件处理
* 使用v-on:xxx 或者@xxx来绑定事件，其中xxx为事件名；
* 事件的回调函数需要配置在methods对象中，最终会在vm上；
* methods中配置的函数，都是被Vue所管理的函数，this的指向是vm或者组件实例对象；
* methods中配置的函数，不要使用箭头函数，否则this就不是vm了；
* @click="demo" 和 @click="demo($event)" 效果一般，但后者可以传参;(实际测试即使不使用$event,在函数中也还是可以取得event的。)
* 

```html
<div id="root">
    <h2>欢迎来到{{name}}学习</h2>
    <!-- <button v-on:click="showInfo">点我弹出提示信息</button> -->
    <!-- 简写形式 -->
    <button @click="showInfo1">点我弹出提示信息1</button>
    <!-- 传递参数 -->
    <button @click="showInfo2(666)">点我弹出提示信息2</button>
    <!-- 传递参数 -->
    <button @click="showInfo3($event,666)">点我弹出提示信息3</button>
</div>

<script>
    Vue.config.productionTip = false  // 阻止 vue在启动时生成生产提示。
    let vm = new Vue({
        el: '#root',
        data: {
            name: '极客堂'
        },
        methods: {
            showInfo1(event){
                console.log(event.target.innerText);    // 点我弹出提示信息
                console.log(this === vm);               // true, 此处的this是vm
                alert("你好，欢迎你");
            },
            showInfo2(number){
                console.log(number);                    // 666
                console.log(event.target.innerText);    // 点我弹出提示信息2
                console.log(this === vm);               // true, 此处的this是vm
                // alert("你好，欢迎你!!!");
            },
            showInfo3(number){
                console.log(number);                    // 666
                console.log(event.target.innerText);    // 点我弹出提示信息3
                console.log(this === vm);               // true, 此处的this是vm
                // alert("你好，欢迎你!!!");
            }
        }
    });
</script>
```


## 修饰符
Vue中的事件修饰符：
1. prevent：阻止默认行为（常用）；
2. stop：阻止事件冒泡（常用）；
3. once：事件只触发一次（常用）；
4. capture：使用事件的捕获模式；
5. self：只有event.target是当前操作的元素时才触发事件；
6. passive：事件的默认行为立即执行，无需等待事件的回调执行完毕；

例如，下面的`@click.prevent`就等价于`e.preventDefault();`
```html
<div id="root">
    <h2>欢迎来到{{name}}</h2>
    <a href="https://geekhall.cn" @click.prevent="showInfo">点我提示信息</a>
</div>

<script>
    Vue.config.productionTip = false  // 阻止 vue在启动时生成生产提示。
    let vm = new Vue({
        el: '#root',
        data: {
            name: '极客堂'
        },
        methods: {
            showInfo(e){
                // e.preventDefault(); // 阻止默认行为
                alert("test");
            }
        }
    });

    
</script>

```

使用@click.stop：阻止事件冒泡；
```html
<div class="demo1" @click="showInfo" style="background-color:skyblue; padding:1rem">
    <button @click.stop="showInfo">点我提示信息</button>
</div>
```


### 键盘事件
```html
<div id="root">
    <h2>欢迎来到{{name}}</h2>
    <input type="text" placeholder="按下回车提示输入" @keyup="showInfo"/>
</div>

<script>
    Vue.config.productionTip = false  // 阻止 vue在启动时生成生产提示。
    let vm = new Vue({
        el: '#root',
        data: {
            name: '极客堂'
        },
        methods: {
            showInfo(e){
                if (e.keyCode == 13)    // 只有当按下回车时才显示内容
                    console.log(e.target.value); 
            }
        }
    });
</script>
```