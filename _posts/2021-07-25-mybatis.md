---
git@gitee.com:sjdt/geekhall.cn.gitlayout: post
title:  "MyBatis 笔记"
date:   2021-07-25 21:14:25 +0800
categories: MyBatis
---



## 1. 配置
### 获取SqlSessionFactory对象
resources 文件夹下新建mybatis-config.xml配置文件，内容如下：
```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-config.dtd">
<configuration>
    <environments default="development">
        <environment id="development">
            <transactionManager type="JDBC"></transactionManager>
            <dataSource type="POOLED">
                <property name="driver" value="com.mysql.jdbc.Driver"/>
                <property name="url" value="jdbc:mysql://127.0.0.1:3316/mybatis?useSSL=true&amp;useUnicode=true&amp;characterEncoding=UTF-8"/>
                <property name="username" value="mybatis"/>
                <property name="password" value="yy123456"/>
            </dataSource>
        </environment>
    </environments>
</configuration>
```

代码中初始化获取SqlSessionFactory对象：
```java

try {
    // 获取SqlSessionFactory对象
    String resource = "mybatis-config.xml";
    InputStream inputStream = Resources.getResourceAsStream(resource);
    SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
} catch (IOException e) {
    e.printStackTrace();
}

```

从SqlSessionFactory中获取SqlSession：
```java


```




### 常见错误
1. org.apache.ibatis.binding.BindingException: Type interface cn.geekhall.dao.UserMapper is not known to the MapperRegistry.

大多数原因都是应为没有添加mappers或者mapper配置的不对，添加即可：
```xml
<mappers>
    <mapper class="cn.geekhall.dao.UserMapper"/>
</mappers>
```
## 配置解析
核心配置文件：mybatis-config.xml

* configuration(配置)
* properties（属性）
* settings（设置）
* typeAliases（类型别名）
```xml
<!--    类型别名是为Java类型设置一个短的名字，只和XML配置有关，存在的意义仅在于用来减少类完全限定名的冗余-->
<typeAliases>
    <typeAlias type="cn.geekhall.pojo.User" alias="User"/>
    <!-- 也可以指定一个包名， MyBatis会在包名下面搜索需要的JavaBean。-->
    <package name="cn.geekhall.pojo"/>
</typeAliases>
```
也可以使用注解来定义别名
```java
@Alias("use")
public class User {}
```

* typeHandlers（类型处理器）
* objectFactory（对象工厂）
* plugins（插件）
* environments（环境配置）
* environment（环境变量）
* transactionManager(事务管理器)
* dataSource（数据源）
* databaseIdProvider（数据库厂商标识）
* mappers（映射器）


